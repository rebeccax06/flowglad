Please set up billing for our app according to the following instructions:

# 1. Server Setup

Do this in a file that can be imported wherever you need to access billing data, or make calls to Flowglad. Flowglad's premade backend modules use the Flowglad Server in sessionful contexts to determine who you're loading billing data for.

Create a `{{SERVER_FILE}}` file, that looks like this:

`// {{SERVER_FILE}}
{{SERVER_INIT}}
`

<Important>
If your customers are organizations rather than individual users, you should use the `getRequestingCustomer` initializer method:

`ts {{SERVER_FILE}}
import { FlowgladServer } from '{SERVER_PKG}'

export const flowgladServer = new FlowgladServer({
  getRequestingCustomer: async () => {
   // whatever logic you currently use to 
   // derive the organization associated with a given request
   return {
     externalId: organizationId,
     name: organizationName,
     email: organizationEmail,
   }
  }
})
`
</Important>

# 2. Set up your Flowglad API route

Create a route handler at `{{ROUTE_HANDLER}}`:

`// {{ROUTE_HANDLER}}
{{ROUTE_HANDLER_CODE}}
`

# 3. Set up React

Add the following to the `{{LAYOUT_FILE}}` file. Preserve the existing layout JSX code. Just:

- {{USER_CHECK_DESCRIPTION}}
- mount the `FlowgladProvider` with the user
- pass the user to the `FlowgladProvider`

`
// {{LAYOUT_FILE}}
{{LAYOUT_IMPORT}}
// ... existing code ...
// inside of the layout component:
{{LAYOUT_GET_USER}}

return (
  {{LAYOUT_PROVIDER}}
    {/* ... existing layout JSX ... */}
    {children}
    {/* ... existing layout JSX ... */}
  {{LAYOUT_PROVIDER_CLOSE}}
) `

# 4. Create a billing page

Create a `{{BILLING_PAGE}}` page in your app and use the `useBilling` hook to load customer billing state:

`tsx {{BILLING_PAGE}}
{{BILLING_PAGE_CODE}}
`